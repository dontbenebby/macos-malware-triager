#!/bin/bash


#this script checks an argument was passed + is valid file
#then runs a series of scripts to assist in triaging macOS malware
#without actually RUNNING said malware

if [ ! -z "$1" ] && [ -f "$1" ]
then
	printf  '/////architecture:\n'
	file $1

	printf  '/////signed?:\n'
	codesign -dvv $1

	printf '/////size:\n'
	du -h $1

	printf '/////linked libraries:\n'
	otool -L $1

	printf '/////strings\n'
	strings - $1

	printf '//////nm:'
	nm $1
else
	printf "You need to specify a file.\nExample usage: ./triage.sh ./GreenLampert/GrowlHelper\nEnding program.\n"
fi

